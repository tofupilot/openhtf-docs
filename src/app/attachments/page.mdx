export const metadata = {
  title: 'OpenHTF Attachments Guide',
  description:
    'A comprehensive guide to attaching files, binary data, and URLs to your OpenHTF test records. Learn how to manage and retrieve attachments, including integration with TofuPilot for secure file handling and automated uploads.',
  keywords: [
    'OpenHTF',
    'attachments',
    'binary data',
    'file attachment',
    'test records',
    'TofuPilot integration',
    'hardware testing',
    'logs',
    'automation',
  ],
  author: 'TofuPilot',
  og: {
    title: 'OpenHTF Attachments Guide',
    description:
      'Learn how to capture, manage, and retrieve attachments in OpenHTF, with full TofuPilot integration for secure file handling.',
    image: '/attachments-header.png',
  },
  twitter: {
    card: 'summary_large_image',
    site: '@YourTwitterHandle',
    title: 'OpenHTF Attachments Guide',
    description:
      'This guide covers how to attach files and data to your OpenHTF test records, including TofuPilot integration.',
    image: '/attachments-header.png',
  },
}

# Attachments

Attach files collected during execution to the test record. {{ className: 'lead' }}

<Image
  src="/attachments-header.png"
  alt="Header of the OpenHTF documentation showing Attachments details and integration with TofuPilot."
/>

## Overview

Hardware tests often generate extra data, such as images, that can't be captured as measurements. OpenHTF allows you to attach these files to the test record.

With the <TofuPilotLink utmMedium="attachments-overview"/> integration, attachments are uploaded automatically and you can access and download them directly from your TofuPilot workspace.

## Files

You can attach binary data or files generated during the test.

```python {{ title: 'main.py' }}
from openhtf import Test, PhaseResult

def attachment_phase(test):
    # Attach a binary log with the identifier "log_data"
    test.attach("log_data", "This is test log data.".encode("utf-8"))
    return PhaseResult.CONTINUE

def main():
    test = Test(attachment_phase)
    test.execute(lambda: "PCB0001")

if __name__ == "__main__":
    main()
```

## Files by path

You can attach larger or pre-existing files from disk or URL.

```python {{ title: 'main.py' }}
from openhtf import Test, PhaseResult

def file_attachment_phase(test):
    # Attach a file from the specified path with the identifier "log_file"
    test.attach_file("log_file", "/path/to/your/logfile.txt")
    return PhaseResult.CONTINUE

def main():
    test = Test(attachment_phase)
    test.execute(lambda: "PCB0001")

if __name__ == "__main__":
    main()
```

## TofuPilot integration

The <TofuPilotLink utmMedium="phases-integration" /> integration is natively compatible with OpenHTF phases.

To integrate TofuPilot, install the open-source client:

```sh
pip install tofupilot[openhtf]
```

Add it to your test like this:

```python {{ title: 'main.py' }}
from openhtf import Test, PhaseResult

def attachment_phase(test):
    test.attach("test_attachment", "Attachment data".encode("utf-8"))
    return PhaseResult.CONTINUE

def main():
    test = Test(attachment_phase)
    with TofuPilot(test):
      test.execute(lambda: "PCB001")

if __name__ == "__main__":
    main()
```

You can access attachments in a dedicated section of the run page, where you can open them in the browser or download them.

<Image
  src="/attachments-page-run.png"
  alt="Attachments section on the OpenHTF run page, showing options to open files in the browser or download them with TofuPilot integration."
/>

---

## Advanced use cases

### Access attachments during execution

You can load and access attached files during test execution.

```python {{ title: 'main.py' }}
from openhtf import Test, PhaseResult

def attachment_phase(test):
    # Attach some data
    test.attach("test_attachment", "Attachment data".encode("utf-8"))

    # Retrieve and print the attached data
    test_attachment = test.get_attachment("test_attachment")
    print(test_attachment)

    return PhaseResult.CONTINUE

def main():
    test = Test(attachment_phase)
    test.execute(lambda: "PCB0001")

if __name__ == "__main__":
    main()
```
