# Plugs

OpenHTF provides a powerful plugin system, known as "plugs," which allows to abstract hardware interactions. They can be used to encapsulate reusable test logic, hardware interfaces, or any other functionality you need. {{ className: 'lead' }}

## Defining plugs

Plugs are defined as classes that inherit from `htf.Plug`.

A plug is a class that inherits from `plugs.BasePlug` and can implement a `tearDown function`. This design makes test scripts cleaner and more modular. Plugs simplify setup and teardown processes, promote code reuse, and can wrap existing Python objects for seamless integrationâ€‹

```python {{ title: 'main.py' }}
import openhtf as htf
from openhtf.plugs import Plug

class MyCustomPlug(Plug):
    def setup(self):
        self.value = 42

    def do_something(self):
        return self.value

@htf.plug(my_plug=MyCustomPlug)
def my_test_phase(test, my_plug):
    result = my_plug.do_something()
    test.logger.info('Plug returned: %s', result)

def main():
    test = htf.Test(my_test_phase)
    test.execute(test_start=lambda: 'DeviceUnderTest123')

if __name__ == '__main__':
    main()
```

## Using plugs in test phases

Plugs can be injected into test phases using the `@htf.plug` decorator. This makes it easy to share plug instances across multiple phases.

```python {{ title: 'main.py' }}
@htf.plug(my_plug=MyCustomPlug)
def another_test_phase(test, my_plug):
    my_plug.value = 100
    test.logger.info('Plug value set to: %s', my_plug.value)

def main():
    test = htf.Test(my_test_phase, another_test_phase)
    test.execute(test_start=lambda: 'DeviceUnderTest456')

if __name__ == '__main__':
    main()
```

## Plug configuration

Plugs can also have their own configurations. You can declare configuration options and load them similarly to how you do it for tests.

```python {{ title: 'main.py' }}
from openhtf.util import conf

# Define configuration options for the plug
conf.declare('custom_value', default_value=10, description='Custom value for the plug')

class ConfigurablePlug(Plug):
    def setup(self):
        self.value = conf.custom_value

    def do_something(self):
        return self.value

@htf.plug(config_plug=ConfigurablePlug)
def config_test_phase(test, config_plug):
    result = config_plug.do_something()
    test.logger.info('Configurable plug returned: %s', result)

def main():
    # Load configuration from file if needed
    conf.load_from_file('config.yaml')

    test = htf.Test(config_test_phase)
    test.execute(test_start=lambda: 'DeviceUnderTest789')

if __name__ == '__main__':
    main()
```
