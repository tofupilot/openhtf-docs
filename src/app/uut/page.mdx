export const metadata = {
  title: 'Unit Under Test (UUT)',
  description:
    'Learn how to track and record the Unit Under Test (UUT) serial number in OpenHTF tests. This guide covers operator prompts, setting programmatically, and TofuPilot integration for full traceability.',
  keywords: [
    'OpenHTF',
    'UUT',
    'Unit Under Test',
    'Unit Under Test',
    'test serial number',
    'traceability',
    'TofuPilot integration',
    'hardware testing',
  ],
  author: 'TofuPilot',
  og: {
    title: 'Unit Under Test (UUT) in OpenHTF',
    description:
      'Learn how to record and manage Unit Under Test (UUT) serial numbers in OpenHTF tests with full traceability, including TofuPilot integration.',
    image: '/UUT-header.png',
  },
  twitter: {
    card: 'summary_large_image',
    site: '@YourTwitterHandle',
    title: 'Unit Under Test (UUT) in OpenHTF',
    description:
      'This guide explains how to handle Unit Under Test (UUT) serial numbers in OpenHTF, with operator prompts and TofuPilot integration.',
    image: '/UUT-header.png',
  },
}

# Unit Under Test

You can track the unit's serial number with each test run. {{ className: 'lead' }}

<Image
  src="/UUT-header.png"
  alt="OpenHTF Unit Under Test (UUT) documentation section header with TofuPilot."
/>

## Overview

When testing Units, tracking the serial number for traceability is essential. OpenHTF lets you enter the serial number manually at the start or set it programmatically at the start or during the test.

By connecting your test scripts to a dedicated database like <TofuPilotLink utmMedium="UUT-overview"/>, the serial number is automatically used to organize the tests for each unit and to compare performance by component revision or batch number.

## Prompt at start

You can prompt the operator to input the serial number manually at the start of the test.

```python {{ title: 'main.py' }}
from openhtf import Test, PhaseResult
from openhtf.plugs import user_input

def power_on(test):
    return PhaseResult.CONTINUE

def main():
    test = Test(power_on)
    test.execute(test_start=user_input.prompt_for_test_start()) # Prompt at start

if __name__ == '__main__':
    main()
```

When executed, the script prompts the user to enter a serial number.

```sh
(venv) C:\tofupilot > python3 main.py
Enter a UUT ID in order to start the test.
--> SI051AB7B0001

======================= test: openhtf_test  outcome: PASS ======================
```

## Set at start

You can set the serial number at the start of the test.

```python {{ title: 'main.py' }}
from openhtf import Test, PhaseResult

def power_on(test):
    return PhaseResult.CONTINUE

def main():
    test = Test(power_on)
    test.execute(test_start=lambda: 'SI051AB7B0001') # Set at start

if __name__ == '__main__':
    main()
```

## Set during test

You can also set the serial number during the test.

```python {{ title: 'main.py' }}
from openhtf import Test, PhaseResult

def get_sn(test):
    test.test_record.UUT_id = 'SI051AB7B0001' # Set during test
    return PhaseResult.CONTINUE

def main():
    test = Test(get_sn)
    test.execute()

if __name__ == '__main__':
    main()
```

## TofuPilot integration

The <TofuPilotLink utmMedium="UUT-integration" /> integration automatically uploads the OpenHTF report to a secure workspace and imports the UUT's serial number.

### Dashboard

A dedicated page is created for each test run, linking to the unit page.

<Image
  src="/UUT-page-run.png"
  alt="OpenHTF Unit Under Test (UUT) documentation section header with TofuPilot."
/>

On the unit page, you can view all test runs conducted on this unit across all procedures.

<Image
  src="/UUT-page-unit.png"
  alt="OpenHTF Unit Under Test (UUT) documentation section header with TofuPilot."
/>

You can specify additional parameters like component, revision, or batch number.

There's also support for [sub-units](https://docs.tofupilot.com/sub-units) to track parts during assembly, each with its own tests.

### One-line integration

To enable the TofuPilot integration, simply install the tofupilot open-source Python client with:

```sh
pip install tofupilot
```

And add the import function in your script:

```python {{ title: 'main.py' }}
from openhtf import Test, PhaseResult
from tofupilot import upload

def power_on(test):
    return PhaseResult.CONTINUE

def main():
    test = Test(power_on)
    test.execute(test_start=lambda: 'SI051AB7B0001')
    tofupilot.upload(test) # activate upload

if __name__ == '__main__':
    main()
```

```python {{ title: 'main.py' }}
from openhtf import Test, PhaseResult

def get_pn_rev(test):
    # Extract the part number and revision from the serial number
    test.test_record.part_number = test.test_record.UUT_id[:5]
    test.test_record.revision = test.test_record.UUT_id[5:7]
    return PhaseResult.CONTINUE

def main():
    test = Test(
        get_pn_rev,
        procedure_id="FVT1", # Procedure ID in TofuPilot
    )
    # TofuPilot callback
    # TODO Felix

    # Serial number set at test start
    test.execute(test_start=lambda: 'SI051AB7B0001')

if __name__ == '__main__':
    main()
```

- If the unit was created in a previous test, no action is needed. - If not,
  specify the `part_number`. - Optionally, add the `revision`. If none is
  provided, 'A' is used by default.

This example extracts the part number and revision from the serial number, but you can also set them manually.

### Component, revision and batch number

```python {{ title: 'main.py' }}
from openhtf import Test, PhaseResult

def get_pn_rev(test):
    # Extract the part number and revision from the serial number
    test.test_record.part_number = test.test_record.UUT_id[:5]
    test.test_record.revision = test.test_record.UUT_id[5:7]
    return PhaseResult.CONTINUE

def main():
    test = Test(
        get_pn_rev,
        procedure_id="FVT1", # Procedure ID in TofuPilot
    )
    # TofuPilot callback
    # TODO Felix

    # Serial number set at test start
    test.execute(test_start=lambda: 'SI051AB7B0001')

if __name__ == '__main__':
    main()
```

### Interface
