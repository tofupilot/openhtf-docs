export const metadata = {
  title: 'Unit Under Test (UUT)',
  description:
    'Learn how to track and record the Unit Under Test (UUT) serial number in OpenHTF tests. This guide covers operator prompts, setting programmatically, and TofuPilot integration for full traceability.',
  keywords: [
    'OpenHTF',
    'UUT',
    'Unit Under Test',
    'Unit Under Test',
    'test serial number',
    'traceability',
    'TofuPilot integration',
    'hardware testing',
  ],
  author: 'TofuPilot',
  og: {
    title: 'Unit Under Test (UUT) in OpenHTF',
    description:
      'Learn how to record and manage Unit Under Test (UUT) serial numbers in OpenHTF tests with full traceability, including TofuPilot integration.',
    image: '/UUT-header.png',
  },
  twitter: {
    card: 'summary_large_image',
    site: '@YourTwitterHandle',
    title: 'Unit Under Test (UUT) in OpenHTF',
    description:
      'This guide explains how to handle Unit Under Test (UUT) serial numbers in OpenHTF, with operator prompts and TofuPilot integration.',
    image: '/UUT-header.png',
  },
}

# Unit Under Test (UUT)

You can track the unit's serial number with each test run. {{ className: 'lead' }}

<Image
  src="/UUT-header.png"
  alt="OpenHTF Unit Under Test (UUT) section header with TofuPilot integration."
/>

## Overview

When testing units, tracking their serial numbers is key for traceability. OpenHTF allows you to manually input the serial number at the start or set it programmatically at any point during the test.

By integrating <TofuPilotLink utmMedium="uut-overview"/> in your test scripts, the UUT's serial number is automatically used to organize test results for each unit and and enables performance comparisons across part numbers, revisions, or batch numbers.

## Prompt at start

You can prompt the operator to input the serial number manually at the start of the test.

```python {{ title: 'main.py' }}
from openhtf import Test, PhaseResult
from openhtf.plugs import user_input

def power_on(test):
    return PhaseResult.CONTINUE

def main():
    test = Test(power_on)
    test.execute(test_start=user_input.prompt_for_test_start()) # Prompt at start

if __name__ == '__main__':
    main()
```

When executed, the script prompts the user to enter a serial number.

```sh
(venv) C:\tofupilot > python3 main.py
Enter a UUT ID in order to start the test.
--> SI051AB7B0001

======================= test: openhtf_test  outcome: PASS ======================
```

## Set at start

You can set the serial number at the start of the test.

```python {{ title: 'main.py' }}
from openhtf import Test, PhaseResult

def power_on(test):
    return PhaseResult.CONTINUE

def main():
    test = Test(power_on)
    test.execute(test_start=lambda: 'SI051AB7B0001') # Set at start

if __name__ == '__main__':
    main()
```

## Set during test

You can also set the serial number during the test.

```python {{ title: 'main.py' }}
from openhtf import Test, PhaseResult

def get_sn(test):
    test.test_record.dut_id = 'SI051AB7B0001' # Set during test
    return PhaseResult.CONTINUE

def main():
    test = Test(get_sn)
    test.execute()

if __name__ == '__main__':
    main()
```

## TofuPilot integration

The <TofuPilotLink utmMedium="uut-integration" /> integration automatically uploads the OpenHTF report to a secure workspace and imports the UUT's serial number.

A dedicated page is created for each test run, linking to the unit page.

<Image
  src="/UUT-page-run.png"
  alt="Test run page for a Unit Under Test (UUT) in OpenHTF with TofuPilot."
/>

On the unit page, you can view all test runs conducted on this unit across all procedures and its sub-units.

<Image
  src="/UUT-page-unit.png"
  alt="Unit page showing all test runs for a Unit Under Test (UUT) in OpenHTF with TofuPilot."
/>

### Simple integration

To enable TofuPilot integration, install the open-source Python client:

```sh
pip install tofupilot
```

And add the `tofupilot.synch` callback before the test execution:

```python {{ title: 'main.py' }}
from openhtf import Test, PhaseResult
import tofupilot

def get_sn(test):
    test.test_record.dut_id = 'SI051AB7B0001'
    return PhaseResult.CONTINUE

def main():
    test = Test(get_sn)
    test.add_output_callbacks(tofupilot.synch()) # Add synch callback before test execution
    test.execute()

if **name** == '**main**':
    main()
```

### Part number, revision, batch number

Additionally, you can specify:

- The `part_number` to differentiate components; TofuPilot creates the component when the first unit is added.
- The `revision` for the version; TofuPilot defaults to revision "A" if none is provided.
- The `batch_number` to track the production batch (optional).

```python {{ title: 'main.py' }}
from openhtf import Test, PhaseResult
import tofupilot

def get_uut(test):
    test.test_record.dut_id = 'SI051AB7B0001'
    test.test_record.part_number = "SI051"  # Part number (required if > 1 components in TofuPilot)
    test.test_record.revision = "AB"        # Revision (optional, defaults to "A")
    test.test_record.batch_number = "09-24" # Batch number (optional)
    return PhaseResult.CONTINUE

def main():
    test = Test(get_uut)
    test.add_output_callbacks(tofupilot.synch())
    test.execute()

if **name** == '**main**':
    main()
```

### Sub-units

You can track tests throughout assembly with TofuPilot's sub-unit feature. Just specify the serial number of an already tested unit, and it will be marked as a sub-unit of the current one. If a part is retested in a new UUT, it automatically changes parent.

```python {{ title: 'main.py' }}
from openhtf import Test, PhaseResult
import tofupilot

def get_units(test):
    test.test_record.dut_id = 'SI051AB7B0001' # UUT
    test.test_record.sub_units = [            # Sub-units
      'SI051AB7B0001',
      'SI051AB7B0001'
    ]
    return PhaseResult.CONTINUE

def main():
    test = Test(get_unit_info)
    test.add_output_callbacks(tofupilot.synch())
    test.execute()

if **name** == '**main**':
    main()
```

Dedicated [API functions](https://docs.tofupilot.com/a-page) are available to manage sub-units outside of tests. All unit activity is shown on their TofuPilot page.

<Image
  src="/UUT-page-unit-activity.png"
  alt="Activity page for a Unit Under Test (UUT) showing sub-units and test history in TofuPilot."
/>
